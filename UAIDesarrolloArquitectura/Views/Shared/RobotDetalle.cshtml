@using Services.Models
@model Robot
<!DOCTYPE html>
<html lang="es">
@{
 ViewBag.Title = "RobotDetalle";
 Services.Idioma.Translator translator = new Services.Idioma.Translator();
 UAIDesarrolloArquitectura.Controllers.IdiomaController lC = new UAIDesarrolloArquitectura.Controllers.IdiomaController();
 lC.InitializeController();
 Services.LanguageService service = lC.GetService();
 service.Susbcribe(translator);
 if (Services.SessionManager.IsLogged()) { service.ChangeLanguage((Services.SessionManager.GetInstance.User.LanguageId).ToString()); }
 else { if (!service.SelectedLanguageExists()) { service.ChangeLanguage("1"); } }
 var estados = new Dictionary<int,string>{{1,"Disponible"},{2,"Activo"},{3,"Mantenimiento"},{4,"Apagado"}};
 string estado = estados.ContainsKey(Model.IdEstadoRobot)? estados[Model.IdEstadoRobot]: Model.IdEstadoRobot.ToString();
 var bateriaPct = Model.Bateria <0 ?0 : (Model.Bateria >100 ?100 : Model.Bateria);
}
<head>
 <meta charset="UTF-8" />
 <meta name="viewport" content="width=device-width, initial-scale=1.0" />
 <title>Detalle Robot</title>
 <link rel="stylesheet" href="~/Content/Site.css" />
 <link rel="preconnect" href="https://fonts.googleapis.com" />
 <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
 <link href="https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet" />
 <style>
 body { font-family:'Chivo', Arial, sans-serif; background:#f5faf5; }
 .layout { display:flex; min-height:calc(100vh -60px); }
 .sidebar { width:240px; background:#e8f5e9; border-right:1px solid #a5d6a7; padding:16px; position:sticky; top:0; height:100vh; }
 .sidebar a { display:flex; align-items:center; gap:8px; color:#1b5e20; text-decoration:none; padding:8px 10px; border-radius:6px; margin-bottom:6px; font-weight:600; }
 .sidebar a .ico { width:18px; height:18px; display:inline-flex; }
 .sidebar a:hover { background:#c8e6c9; }
 .content { flex:1; padding:32px 48px 40px; }
 .wrapper { max-width:980px; margin:0 auto; }
 .card { background:#fff; border:1px solid #d8e2d8; border-radius:20px; padding:24px 32px; }
 h2 { margin:0012px; font-size:26px; color:#2E7D32; }
 .meta p { margin:6px 0; font-size:15px; color:#1b5e20; }
 .pill { display:inline-block; padding:6px 12px; border-radius:16px; background:#e8f5e9; font-weight:600; font-size:13px; }
 .battery-wrap { margin-top:10px; display:flex; align-items:center; gap:12px; }
 .battery-bar { width:200px; height:14px; background:#ececec; border-radius:10px; overflow:hidden; }
 .battery-fill { height:100%; background:linear-gradient(90deg,#66bb6a,#43A047); width:@bateriaPct; }
 .battery-low .battery-fill { background:linear-gradient(90deg,#ef5350,#c62828); }
 .actions { margin-top:22px; display:flex; gap:14px; }
 .btn { cursor:pointer; border:none; padding:10px 18px; border-radius:14px; font-weight:600; font-size:13px; background:#2E7D32; color:#fff; }
 .btn:hover { background:#1b5e20; }
 .back-link { display:inline-block; margin:0016px; font-size:13px; text-decoration:none; color:#2E7D32; font-weight:600; }
 .back-link:hover { text-decoration:underline; }
 </style>
</head>
<body>
 <nav class="barra">
 @if (Services.SessionManager.IsLogged())
 {
 <div id="opciones" class="opciones">
 <a href="@Url.Action("Logout","Home")">@translator.GetTraduction(service,"Logout")</a>
 <a style="display:none;" id="bitacora" href="@Url.Action("Bitacora","Bitacora")">@translator.GetTraduction(service,"Log")</a>
 <a style="display:none;" id="abmusuarios" href="@Url.Action("ABMUsuarios","ABM")">@translator.GetTraduction(service,"ManageUser")</a>
 <a style="display:none;" id="restore" href="@Url.Action("BackupRestore","Backup")">@translator.GetTraduction(service,"Restoredb")</a>
 <a style="display:none;" id="1001" href="@Url.Action("ABMIdioma","Idioma")">@translator.GetTraduction(service,"ManageLanguage")</a>
 <a style="display:none;" id="1002" href="@Url.Action("CrearPerfiles","CrearPerfiles")">@translator.GetTraduction(service,"CreateProfile")</a>
 <a style="display:none;" id="1003" href="@Url.Action("AsignarPerfil","AsignarPerfil")">@translator.GetTraduction(service,"AssignProfile")</a>
 <script type="text/javascript">@foreach (string permission in Services.SessionManager.GetInstance.User.permissionList){<text>document.getElementById('@permission').style.display='block';</text>}</script>
 </div>
 <div class="opciones"><p style="color:white;">@translator.GetTraduction(service,"Welcome"), @Services.SessionManager.GetInstance.User.Name</p></div>
 }
 else
 {
 <a href="@Url.Action("Login","Login")">@translator.GetTraduction(service,"Login")</a>
 <a href="@Url.Action("Register","Register")">@translator.GetTraduction(service,"Register")</a>
 }
 <form>
 <select id="option" onchange="enviarValor()">@foreach (Services.Idioma.Language l in service.GetLanguages())
 {
 if (service.SelectedLanguage.Id == l.Id)
 {<option value="@l.Id" selected>@translator.GetTraduction(service,l.Name)</option>}
 else
 {<option value="@l.Id">@translator.GetTraduction(service,l.Name)</option>}
 }</select>
 </form>
 </nav>
 <div class="layout">
 <aside class="sidebar">
 <a href="@Url.Action("Robots","Home")" class="active"><span class="ico">@Html.Raw("<svg fill='#2E7D32' viewBox='002424'><path d='M72h10v4h3a2200122v4h-2V8h-3v4H7V8H4v4H2V8a220012-2h3V2zm22v2h6V4H9zm-49h14v9H5v-9zm42v5h2v-5H9zm60v5h2v-5h-2z'/></svg>")</span><span>@translator.GetTraduction(service,"RobotsManagement")</span></a>
 <a href="@Url.Action("Mantenimientos","Home")"><span class="ico">@Html.Raw("<svg fill='#2E7D32' viewBox='002424'><path d='M20.34.6318.73l-.4-1.7-3.6-.8L15.92.98l-2.782.7L9.124.64l-.9.43-.73.6.8.432.72-.6.73.64.8.53.9L1211.1l3.91.9.5-3.93.6-.8-.3-3.7zM1216a44010-804400080z'/></svg>")</span><span>@translator.GetTraduction(service,"Maintenance")</span></a>
 <a href="@Url.Action("Telemetria","Home")"><span class="ico">@Html.Raw("<svg fill='#2E7D32' viewBox='002424'><path d='M33h2v18H3V3zm160h2v18h-2V3zM93h2v13H9V3zm45h2v18h-2V8z'/></svg>")</span><span>@translator.GetTraduction(service,"Telemetry")</span></a>
 <a href="@Url.Action("ContactUs","Home")"><span class="ico">@Html.Raw("<svg fill='#2E7D32' viewBox='002424'><path d='M44h16v12H5.17L417.17V4zm22v8h12V6H6zm410h2a5.55.50015.55.5H9a5.55.50015.5-5.5z'/></svg>")</span><span>@translator.GetTraduction(service,"Contact")</span></a>
 </aside>
 <main class="content">
 <div class="wrapper">
 <a class="back-link" href="@Url.Action("Robots","Home")">← Volver</a>
 <div class="card">
 <h2>@Model.Nombre</h2>
 <div class="meta">
 <p><strong>ID:</strong> @Model.Id</p>
 <p><strong>Número Serie:</strong> @Model.NumeroSerie</p>
 <p><strong>Estado:</strong> <span class="pill">@estado</span></p>
 <p><strong>Fecha Alta:</strong> @(Model.FechaAlta.HasValue? Model.FechaAlta.Value.ToString("yyyy-MM-dd") : "-")</p>
 <p><strong>Batería:</strong></p>
 <div class="battery-wrap @(bateriaPct<=15?"battery-low":"")">
 <div class="battery-bar"><div class="battery-fill" style="width:@bateriaPct;"></div></div>
 <span>@bateriaPct%</span>
 </div>
 </div>
 <div class="actions">
 <button class="btn" onclick="cambiarEstado(@Model.Id,2)">Activar</button>
 <button class="btn" onclick="cambiarEstado(@Model.Id,4)">Apagar</button>
 <button class="btn" onclick="editar(@Model.Id)">Editar</button>
 </div>
 </div>
 </div>
 </main>
 </div>
 <footer>©2026 AgroMinds — Tecnología agrícola inteligente.</footer>
 <script>
 function cambiarEstado(id,estado){ fetch('/Robot/ChangeState',{ method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ id:id, newState:estado }) }) .then(r=>r.json()).then(x=>{ if(x.success){ location.reload(); } else { alert(x.error||'Error'); } }); }
 function editar(id){ alert('Editar robot '+id); }
 </script>
</body>
</html>