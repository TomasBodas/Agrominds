@{
 ViewBag.Title = "Reset Password";
}
<!DOCTYPE html>
<html lang="es">
<head>
 <meta charset="UTF-8" />
 <meta name="viewport" content="width=device-width, initial-scale=1.0" />
 <title>Recuperar contraseña</title>
 <link rel="stylesheet" href="~/Content/Site.css" />
</head>
<body>
 <nav class="barra">
 <a href="@Url.Action("Index","Home")">Inicio</a>
 </nav>
 <header>
 <h1 style="color:#2E7D32;">AgroMinds</h1>
 </header>
 <main style="max-width:720px;margin:30px auto;padding:20px;">
 <div class="card" style="background:#fff;border-left:4px solid #2E7D32;padding:18px;border-radius:8px;box-shadow:0 8px 24px rgba(46,125,50,0.08);">
 <h2>Restablecer contraseña</h2>
 <p>Confirma tu identidad estableciendo una nueva contraseña para la cuenta:</p>
 <p><strong>@(ViewBag.Email ?? "")</strong></p>
 <form id="resetForm" method="post" action="@Url.Action("CompleteReset","Login")" style="margin-top:10px;display:flex;flex-direction:column;gap:10px;">
 <input type="hidden" name="t" value="@ViewBag.Token" />
 <label for="np">Nueva contraseña</label>
 <input id="np" type="password" name="newPassword" required />
 <button type="submit" class="btn">Guardar</button>
 </form>
 </div>
 </main>
 <footer style="background:#2E7D32;color:#fff;padding:10px;text-align:center;">©2026 AgroMinds — Todos los derechos reservados.</footer>
 <script>
 (function(){
 var f=document.getElementById('resetForm');
 if(!f) return;
 f.addEventListener('submit', function(e){
 e.preventDefault();
 var fd=new FormData(f);
 fetch(f.action, { method:'POST', body: fd })
 .then(r=>r.json())
 .then(x=>{
 if(x && x.success){ alert('Contraseña actualizada'); window.location='@Url.Action("Login","Login")'; }
 else { alert((x&&x.error)||'Error'); }
 })
 .catch(()=>alert('Error'));
 });
 })();
 </script>
</body>
</html>